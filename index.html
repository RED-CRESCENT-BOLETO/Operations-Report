<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø§Ù„Ù…Ù†ÙØµÙ„ - Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¯Ù‚ÙŠÙ‚</title>
    <style>
        :root { --ls-red: #b32633; --sb-blue: #0056b3; --gold: #ffd700; --bg: #0a0a0a; --card-bg: #161616; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #000; color: white; margin: 0; padding: 0; overflow-x: hidden; }
        .system-header { display: flex; width: 100%; height: 60px; border-bottom: 2px solid #333; }
        .nav-btn { flex: 1; border: none; cursor: pointer; font-size: 20px; font-weight: bold; color: #888; background: #111; transition: 0.3s; }
        .nav-btn.active-ls { background: var(--ls-red); color: white; }
        .nav-btn.active-sb { background: var(--sb-blue); color: white; }
        
        .main-content { padding: 20px; display: none; }
        .main-content.active { display: block; }

        .control-panel { background: #111; padding: 20px; border-radius: 15px; border: 1px solid #333; margin-bottom: 25px; text-align: center; }
        .letter-row { margin-bottom: 15px; display: flex; justify-content: center; gap: 5px; flex-wrap: wrap; }
        .l-btn { width: 45px; height: 45px; border-radius: 8px; border: 1px solid #444; background: #222; color: white; font-weight: bold; cursor: pointer; }
        .l-btn.active { background: var(--gold); color: black; border-color: white; }
        
        .big-input { font-size: 60px; width: 220px; text-align: center; background: #000; color: white; border: 3px solid #444; border-radius: 15px; outline: none; }
        .ls-input { border-color: var(--ls-red); color: var(--ls-red); }
        .sb-input { border-color: var(--sb-blue); color: var(--sb-blue); }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .card { background: var(--card-bg); border-radius: 10px; border: 1px solid #333; min-height: 120px; }
        .card-h { padding: 10px; text-align: center; font-weight: bold; font-size: 15px; background: #222; border-bottom: 1px solid #333; }
        .ls-card-h { border-top: 4px solid var(--ls-red); }
        .sb-card-h { border-top: 4px solid var(--sb-blue); }
        .card-b { padding: 10px; display: flex; flex-wrap: wrap; gap: 6px; justify-content: center; }
        
        .unit { background: #000; border: 1px solid #444; padding: 5px 12px; border-radius: 5px; font-weight: bold; font-size: 14px; cursor: pointer; }
        .unit:hover { border-color: red; }

        .footer { position: fixed; bottom: 0; width: 100%; background: #050505; padding: 15px; border-top: 2px solid #333; display: flex; justify-content: center; gap: 20px; }
        .action-btn { padding: 12px 40px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; font-size: 18px; }
    </style>
</head>
<body>

<div class="system-header">
    <button id="lsTab" class="nav-btn active-ls" onclick="switchSys('LS')">Ù†Ø¸Ø§Ù… Ù„ÙˆØ³ Ø³Ø§Ù†ØªÙˆØ³ (LS)</button>
    <button id="sbTab" class="nav-btn" onclick="switchSys('SB')">Ù†Ø¸Ø§Ù… Ø³Ø§Ù†Ø¯ÙŠ ÙˆØ¨ÙˆÙ„ÙŠØªÙˆ (SB)</button>
</div>

<div id="lsContent" class="main-content active">
    <div class="control-panel">
        <div class="letter-row" id="lsLetters"></div>
        <input type="text" id="lsIn" class="big-input ls-input" placeholder="000" maxlength="4">
        <div style="margin-top: 15px;">
            <button class="action-btn" style="background:#444; color:white;" onclick="undo('LS')">ØªØ±Ø§Ø¬Ø¹ â†©ï¸</button>
            <button class="action-btn" style="background:#600; color:white;" onclick="resetSys('LS')">ØªØµÙÙŠØ± Ù„ÙˆØ³ âš ï¸</button>
        </div>
    </div>
    <div class="grid" id="lsGrid"></div>
</div>

<div id="sbContent" class="main-content">
    <div class="control-panel">
        <div class="letter-row" id="sbLetters"></div>
        <input type="text" id="sbIn" class="big-input sb-input" placeholder="000" maxlength="4">
        <div style="margin-top: 15px;">
            <button class="action-btn" style="background:#444; color:white;" onclick="undo('SB')">ØªØ±Ø§Ø¬Ø¹ â†©ï¸</button>
            <button class="action-btn" style="background:#600; color:white;" onclick="resetSys('SB')">ØªØµÙÙŠØ± Ø³Ø§Ù†Ø¯ÙŠ âš ï¸</button>
        </div>
    </div>
    <div class="grid" id="sbGrid"></div>
</div>

<div class="footer">
    <button class="action-btn" style="background: #28a745; color: white;" onclick="copyRep()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
</div>

<script>
    let activeSys = 'LS';
    let letters = { LS: 'E', SB: 'E' };
    let history = { LS: [], SB: [] };

    const keysLS = ["Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", "Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", "Ù„Ø§Ù… 2", "Ù„Ø§Ù… 4", "Ù„Ø§Ù… 3", "Ù„Ø§Ù… 1", "ÙØ±Ø³Ø§Ù†", "Ù„Ø§Ù… 5", "Ø¯Ø¹Ù…", "Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡", "ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ùˆ Ø§Ù„Ø§Ù†Ù‚Ø§Ø°", "Ù‚ÙŠØ§Ø¯Ø©", "Ø§Ø´Ø±Ø§Ù Ø¹Ø§Ù…", "Ù…Ø´Ø±Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ", "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬"];
    const keysSB = ["Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", "Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", "Ø³ÙŠÙ† 1", "Ø¨Ø§Ø¡ 1", "Ø³ÙŠÙ†", "Ø¬ÙŠÙ… 1", "Ø¨Ø§Ø¡", "Ø¬ÙŠÙ… 2", "Ø¯Ø¹Ù…", "Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡", "ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ùˆ Ø§Ù„Ø§Ù†Ù‚Ø§Ø°", "Ù‚ÙŠØ§Ø¯Ø©", "Ø§Ø´Ø±Ø§Ù Ø¹Ø§Ù…", "Ù…Ø´Ø±Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ", "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬"];

    let dataLS = {}; keysLS.forEach(k => dataLS[k] = []);
    let dataSB = {}; keysSB.forEach(k => dataSB[k] = []);

    // --- Ù…Ù†Ø·Ù‚ ØªÙˆØ²ÙŠØ¹ Ù„ÙˆØ³ (Ù…Ø³ØªÙ‚Ù„) ---
    function getLsTarget() {
        if (dataLS["Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª"].length === 0) return "Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª";
        if (dataLS["Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª"].length === 0) return "Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª";
        let l1 = dataLS["Ù„Ø§Ù… 1"].length, l2 = dataLS["Ù„Ø§Ù… 2"].length, l3 = dataLS["Ù„Ø§Ù… 3"].length, l4 = dataLS["Ù„Ø§Ù… 4"].length, l5 = dataLS["Ù„Ø§Ù… 5"].length, f = dataLS["ÙØ±Ø³Ø§Ù†"].length;
        let sum = l1+l2+l3+l4+f;

        if (l2<1) return "Ù„Ø§Ù… 2"; if (l4<1) return "Ù„Ø§Ù… 4"; if (l3<1) return "Ù„Ø§Ù… 3"; if (l1<1) return "Ù„Ø§Ù… 1"; if (f<1) return "ÙØ±Ø³Ø§Ù†";
        if (l2<2) return "Ù„Ø§Ù… 2"; if (l4<2) return "Ù„Ø§Ù… 4"; if (l3<2) return "Ù„Ø§Ù… 3"; if (l1<2) return "Ù„Ø§Ù… 1";
        if (l2<3) return "Ù„Ø§Ù… 2"; if (l4<3) return "Ù„Ø§Ù… 4"; if (l1<3) return "Ù„Ø§Ù… 1";
        if (l5<1) return "Ù„Ø§Ù… 5";
        return "Ù„Ø§Ù… 2";
    }

    // --- Ù…Ù†Ø·Ù‚ ØªÙˆØ²ÙŠØ¹ Ø³Ø§Ù†Ø¯ÙŠ (Ù…Ø³ØªÙ‚Ù„) ---
    function getSbTarget() {
        if (dataSB["Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª"].length === 0) return "Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª";
        if (dataSB["Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª"].length === 0) return "Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª";
        let s1 = dataSB["Ø³ÙŠÙ† 1"].length, b1 = dataSB["Ø¨Ø§Ø¡ 1"].length, s = dataSB["Ø³ÙŠÙ†"].length, g1 = dataSB["Ø¬ÙŠÙ… 1"].length, b = dataSB["Ø¨Ø§Ø¡"].length, g2 = dataSB["Ø¬ÙŠÙ… 2"].length;
        let sum = s1+b1+s+g1+b;

        if (s1<1) return "Ø³ÙŠÙ† 1"; if (b1<1) return "Ø¨Ø§Ø¡ 1"; if (s<1) return "Ø³ÙŠÙ†"; if (g1<1) return "Ø¬ÙŠÙ… 1"; if (b<1) return "Ø¨Ø§Ø¡";
        if (s1<2) return "Ø³ÙŠÙ† 1"; if (b1<2) return "Ø¨Ø§Ø¡ 1"; if (s<2) return "Ø³ÙŠÙ†"; if (g1<2) return "Ø¬ÙŠÙ… 1"; if (b<2) return "Ø¨Ø§Ø¡";
        if (s1<3) return "Ø³ÙŠÙ† 1"; if (b1<3) return "Ø¨Ø§Ø¡ 1"; if (s<3) return "Ø³ÙŠÙ†"; if (g1<3) return "Ø¬ÙŠÙ… 1";
        if (s1<4) return "Ø³ÙŠÙ† 1"; if (s<4) return "Ø³ÙŠÙ†"; if (b<3) return "Ø¨Ø§Ø¡"; if (b<4) return "Ø¨Ø§Ø¡";
        if (g2<3) return "Ø¬ÙŠÙ… 2";
        return "Ø³ÙŠÙ† 1";
    }

    function handleInput(sys, val) {
        if (val.length >= 3) {
            let full = letters[sys] + "-" + val;
            let target = (sys === 'LS' ? getLsTarget() : getSbTarget());
            let d = (sys === 'LS' ? dataLS : dataSB);
            
            let exists = false;
            for(let k in d) if(d[k].includes(full)) exists = true;
            if(exists && !["Ù‚ÙŠØ§Ø¯Ø©","Ø§Ø´Ø±Ø§Ù Ø¹Ø§Ù…","Ù…Ø´Ø±Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ"].includes(target)) {
                alert("Ø§Ù„ÙƒÙˆØ¯ Ù…ÙƒØ±Ø±!");
            } else {
                d[target].push(full);
                history[sys].push(target);
            }
            document.getElementById(sys === 'LS' ? 'lsIn' : 'sbIn').value = '';
            render();
        }
    }

    document.getElementById('lsIn').oninput = (e) => handleInput('LS', e.target.value.replace(/\D/g,''));
    document.getElementById('sbIn').oninput = (e) => handleInput('SB', e.target.value.replace(/\D/g,''));

    function render() {
        // Ø±Ù†Ø¯Ø± Ù„ÙˆØ³
        let lsG = document.getElementById('lsGrid'); lsG.innerHTML = '';
        keysLS.forEach(k => {
            lsG.innerHTML += `<div class="card"><div class="card-h ls-card-h">${k}</div><div class="card-b">${dataLS[k].map((u,i)=>`<div class="unit" onclick="delUnit('LS','${k}',${i})">${u}</div>`).join('')}</div></div>`;
        });
        // Ø±Ù†Ø¯Ø± Ø³Ø§Ù†Ø¯ÙŠ
        let sbG = document.getElementById('sbGrid'); sbG.innerHTML = '';
        keysSB.forEach(k => {
            sbG.innerHTML += `<div class="card"><div class="card-h sb-card-h">${k}</div><div class="card-b">${dataSB[k].map((u,i)=>`<div class="unit" onclick="delUnit('SB','${k}',${i})">${u}</div>`).join('')}</div></div>`;
        });
    }

    function switchSys(sys) {
        activeSys = sys;
        document.getElementById('lsContent').classList.toggle('active', sys==='LS');
        document.getElementById('sbContent').classList.toggle('active', sys==='SB');
        document.getElementById('lsTab').className = 'nav-btn' + (sys==='LS'?' active-ls':'');
        document.getElementById('sbTab').className = 'nav-btn' + (sys==='SB'?' active-sb':'');
    }

    function delUnit(sys,k,i) { if(confirm("Ø­Ø°ÙØŸ")) { (sys==='LS'?dataLS:dataSB)[k].splice(i,1); render(); } }
    function undo(sys) { if(history[sys].length) { let t = history[sys].pop(); (sys==='LS'?dataLS:dataSB)[t].pop(); render(); } }
    function resetSys(sys) { if(confirm("ØªØµÙÙŠØ± Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… ÙÙ‚Ø·ØŸ")) { let d = (sys==='LS'?dataLS:dataSB); for(let k in d) d[k]=[]; history[sys]=[]; render(); } }

    function copyRep() {
        let sys = activeSys; let d = (sys==='LS'?dataLS:dataSB); let ks = (sys==='LS'?keysLS:keysSB);
        let txt = `ØªÙ‚Ø±ÙŠØ± Ø¹Ù…Ù„ÙŠØ§Øª (${sys==='LS'?'Ù„ÙˆØ³ Ø³Ø§Ù†ØªÙˆØ³':'Ø³Ø§Ù†Ø¯ÙŠ ÙˆØ¨ÙˆÙ„ÙŠØªÙˆ'})\n\n`;
        ks.forEach(k => {
            let units = d[k].length ? ( (k.includes("Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª")) ? d[k].join(' | ')+" |" : d[k].join('\n') ) : "E-000";
            txt += `${k} :\n${units}\n\n`;
        });
        navigator.clipboard.writeText(txt); alert("ØªÙ… Ø§Ù„Ù†Ø³Ø® Ø¨Ù†Ø¬Ø§Ø­");
    }

    // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø­Ø±ÙˆÙ Ù„ÙƒÙ„ Ù‚Ø³Ù…
    ['LS','SB'].forEach(sys => {
        let div = document.getElementById(sys.toLowerCase()+'Letters');
        ['E','A','F','M','S','C','G','P','H'].forEach(l => {
            let b = document.createElement('button'); b.className = 'l-btn' + (l==='E'?' active':''); b.innerText = l;
            b.onclick = () => { letters[sys] = l; div.querySelectorAll('.l-btn').forEach(x=>x.classList.remove('active')); b.classList.add('active'); };
            div.appendChild(b);
        });
    });

    render();
</script>
</body>
</html>
