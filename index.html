<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø·ÙˆØ±</title>
    <style>
        :root { --red: #b32633; --blue: #0056b3; --gold: #ffd700; --bg: #0a0a0a; --purple: #6a1b9a; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #111; color: white; margin: 0; padding: 10px; }
        .container { max-width: 1200px; margin: auto; background: rgba(0,0,0,0.9); padding: 20px; border-radius: 15px; border: 1px solid #333; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 15px; font-size: 20px; font-weight: bold; cursor: pointer; border: none; border-radius: 8px; background: #333; color: white; }
        .tab-btn.active-ls { background: var(--red); box-shadow: 0 0 10px var(--red); }
        .tab-btn.active-sb { background: var(--blue); box-shadow: 0 0 10px var(--blue); }
        
        .main-input-area { background: #222; padding: 20px; border-radius: 12px; text-align: center; margin-bottom: 20px; }
        .input-box { font-size: 40px; width: 150px; text-align: center; background: #000; color: var(--gold); border: 2px solid #444; border-radius: 10px; margin: 10px; }
        .letter-btn { width: 50px; height: 50px; margin: 2px; cursor: pointer; background: #444; color: white; border: none; border-radius: 5px; font-weight: bold; }
        .letter-btn.active { background: var(--gold); color: black; }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; }
        .card { background: #1a1a1a; border-radius: 8px; overflow: hidden; border: 1px solid #333; }
        .card-header { padding: 10px; text-align: center; font-weight: bold; font-size: 14px; background: #333; }
        .ls-h { background: var(--red); }
        .sb-h { background: var(--blue); }
        .card-body { padding: 10px; min-height: 50px; display: flex; flex-wrap: wrap; gap: 5px; }
        .unit-tag { background: #000; padding: 5px 10px; border-radius: 4px; font-size: 13px; border: 1px solid #444; position: relative; cursor: pointer; }
        
        .copy-btn { width: 100%; padding: 20px; background: #28a745; color: white; font-size: 22px; font-weight: bold; border: none; border-radius: 10px; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div class="tabs">
        <button id="btnLS" class="tab-btn active-ls" onclick="setMode('LS')">Ù„ÙˆØ³ Ø³Ø§Ù†ØªÙˆØ³</button>
        <button id="btnSB" class="tab-btn" onclick="setMode('SB')">Ø³Ø§Ù†Ø¯ÙŠ ÙˆØ¨ÙˆÙ„ÙŠØªÙˆ</button>
    </div>

    <div class="main-input-area">
        <div id="letters"></div>
        <input type="text" id="codeIn" class="input-box" placeholder="000" maxlength="4">
        <div style="margin-top: 10px;">
            <button onclick="undo()" style="padding:10px 20px;">ØªØ±Ø§Ø¬Ø¹ â†©ï¸</button>
            <button onclick="resetData()" style="padding:10px 20px; background:#600; color:white;">ØªØµÙÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± âš ï¸</button>
        </div>
    </div>

    <div id="displayArea" class="grid"></div>

    <button class="copy-btn" onclick="copyReport()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
</div>

<script>
    let mode = 'LS';
    let activeLetter = 'E';
    let history = [];

    const keysLS = ["Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", "Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", "Ù„Ø§Ù… 2", "Ù„Ø§Ù… 4", "Ù„Ø§Ù… 3", "Ù„Ø§Ù… 1", "ÙØ±Ø³Ø§Ù†", "Ù„Ø§Ù… 5", "Ø¯Ø¹Ù…", "Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡", "ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ùˆ Ø§Ù„Ø§Ù†Ù‚Ø§Ø°", "Ù‚ÙŠØ§Ø¯Ø©", "Ø§Ø´Ø±Ø§Ù Ø¹Ø§Ù…", "Ù…Ø´Ø±Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ", "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬"];
    const keysSB = ["Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", "Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", "Ø³ÙŠÙ† 1", "Ø¨Ø§Ø¡ 1", "Ø³ÙŠÙ†", "Ø¬ÙŠÙ… 1", "Ø¨Ø§Ø¡", "Ø¬ÙŠÙ… 2", "Ø¯Ø¹Ù…", "Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡", "ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ùˆ Ø§Ù„Ø§Ù†Ù‚Ø§Ø°", "Ù‚ÙŠØ§Ø¯Ø©", "Ø§Ø´Ø±Ø§Ù Ø¹Ø§Ù…", "Ù…Ø´Ø±Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ", "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬"];

    let data = { LS: {}, SB: {} };
    keysLS.forEach(k => data.LS[k] = []);
    keysSB.forEach(k => data.SB[k] = []);

    // --- Ù…Ù†Ø·Ù‚ ØªÙˆØ²ÙŠØ¹ Ù„ÙˆØ³ Ø³Ø§Ù†ØªÙˆØ³ Ø§Ù„Ø­Ø±ÙÙŠ ---
    function getTargetLS() {
        let d = data.LS;
        if (d["Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª"].length === 0) return "Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª";
        if (d["Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª"].length === 0) return "Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª";

        let l2 = d["Ù„Ø§Ù… 2"].length, l4 = d["Ù„Ø§Ù… 4"].length, l3 = d["Ù„Ø§Ù… 3"].length, l1 = d["Ù„Ø§Ù… 1"].length, f = d["ÙØ±Ø³Ø§Ù†"].length, l5 = d["Ù„Ø§Ù… 5"].length;
        let total = l2 + l4 + l3 + l1 + f + l5;

        // Ø§Ù„Ø­Ø§Ù„Ø© 1: 5 ÙˆØ­Ø¯Ø§Øª ÙÙ‚Ø· (ÙˆØ­Ø¯Ø© Ù„ÙƒÙ„ Ù…Ù†Ø·Ù‚Ø©)
        if (total < 5) {
            if (l2 < 1) return "Ù„Ø§Ù… 2";
            if (l4 < 1) return "Ù„Ø§Ù… 4";
            if (l3 < 1) return "Ù„Ø§Ù… 3";
            if (l1 < 1) return "Ù„Ø§Ù… 1";
            if (f < 1) return "ÙØ±Ø³Ø§Ù†";
        }
        // Ø§Ù„Ø­Ø§Ù„Ø© 2: Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø³Ø§Ø¯Ø³Ø© ØªØ°Ù‡Ø¨ Ù„Ù€ Ù„Ø§Ù… 2 (ØªØµØ¨Ø­ 2)
        if (total === 5) return "Ù„Ø§Ù… 2";
        // Ø§Ù„Ø­Ø§Ù„Ø© 3: Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø³Ø§Ø¨Ø¹Ø© ØªØ°Ù‡Ø¨ Ù„Ù€ Ù„Ø§Ù… 4 (ØªØµØ¨Ø­ 2)
        if (total === 6) return "Ù„Ø§Ù… 4";
        // Ø§Ù„Ø­Ø§Ù„Ø© 4: Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø«Ø§Ù…Ù†Ø© ØªØ°Ù‡Ø¨ Ù„Ù€ Ù„Ø§Ù… 3 (ØªØµØ¨Ø­ 2)
        if (total === 7) return "Ù„Ø§Ù… 3";
        // Ø§Ù„Ø­Ø§Ù„Ø© 5: Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ§Ø³Ø¹Ø© ØªØ°Ù‡Ø¨ Ù„Ù€ Ù„Ø§Ù… 1 (ØªØµØ¨Ø­ 2)
        if (total === 8) return "Ù„Ø§Ù… 1";
        // Ø§Ù„Ø­Ø§Ù„Ø© 6: Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¹Ø§Ø´Ø±Ø© ØªØ°Ù‡Ø¨ Ù„Ù€ Ù„Ø§Ù… 2 (ØªØµØ¨Ø­ 3)
        if (total === 9) return "Ù„Ø§Ù… 2";
        // Ø§Ù„Ø­Ø§Ù„Ø© 7: Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø­Ø§Ø¯ÙŠØ© Ø¹Ø´Ø± ØªØ°Ù‡Ø¨ Ù„Ù€ Ù„Ø§Ù… 4 (ØªØµØ¨Ø­ 3)
        if (total === 10) return "Ù„Ø§Ù… 4";
        // Ø§Ù„Ø­Ø§Ù„Ø© 8: Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ø¹Ø´Ø± ØªØ°Ù‡Ø¨ Ù„Ù€ Ù„Ø§Ù… 1 (ØªØµØ¨Ø­ 3)
        if (total === 11) return "Ù„Ø§Ù… 1";
        // Ø§Ù„Ø­Ø§Ù„Ø© 9: Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© Ø¹Ø´Ø± ØªØ°Ù‡Ø¨ Ù„Ù€ Ù„Ø§Ù… 5
        if (total === 12) return "Ù„Ø§Ù… 5";

        return "Ù„Ø§Ù… 2"; // Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ
    }

    // --- Ù…Ù†Ø·Ù‚ ØªÙˆØ²ÙŠØ¹ Ø³Ø§Ù†Ø¯ÙŠ ÙˆØ¨ÙˆÙ„ÙŠØªÙˆ Ø§Ù„Ø­Ø±ÙÙŠ ---
    function getTargetSB() {
        let d = data.SB;
        if (d["Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª"].length === 0) return "Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª";
        if (d["Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª"].length === 0) return "Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª";

        let s1 = d["Ø³ÙŠÙ† 1"].length, b1 = d["Ø¨Ø§Ø¡ 1"].length, s = d["Ø³ÙŠÙ†"].length, g1 = d["Ø¬ÙŠÙ… 1"].length, b = d["Ø¨Ø§Ø¡"].length, g2 = d["Ø¬ÙŠÙ… 2"].length;
        let total = s1 + b1 + s + g1 + b + g2;

        // Ø§Ù„Ø­Ø§Ù„Ø© 1: ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (ÙˆØ­Ø¯Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ÙƒÙ„ Ù…Ù†Ø·Ù‚Ø© Ù…Ø§ Ø¹Ø¯Ø§ Ø¬ÙŠÙ… 2)
        if (total < 5) {
            if (s1 < 1) return "Ø³ÙŠÙ† 1";
            if (b1 < 1) return "Ø¨Ø§Ø¡ 1";
            if (s < 1) return "Ø³ÙŠÙ†";
            if (g1 < 1) return "Ø¬ÙŠÙ… 1";
            if (b < 1) return "Ø¨Ø§Ø¡";
        }
        // Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø­Ø³Ø¨ Ù†ØµÙƒ:
        if (total === 5) return "Ø³ÙŠÙ† 1"; // ØªØµØ¨Ø­ Ø³ÙŠÙ† 1 ÙˆØ­Ø¯ØªÙŠÙ†
        if (total === 6) return "Ø¨Ø§Ø¡ 1"; // ØªØµØ¨Ø­ Ø¨Ø§Ø¡ 1 ÙˆØ­Ø¯ØªÙŠÙ†
        if (total === 7) return "Ø³ÙŠÙ†";   // ØªØµØ¨Ø­ Ø³ÙŠÙ† ÙˆØ­Ø¯ØªÙŠÙ†
        if (total === 8) return "Ø¬ÙŠÙ… 1"; // ØªØµØ¨Ø­ Ø¬ÙŠÙ… 1 ÙˆØ­Ø¯ØªÙŠÙ†
        if (total === 9) return "Ø¨Ø§Ø¡";   // ØªØµØ¨Ø­ Ø¨Ø§Ø¡ ÙˆØ­Ø¯ØªÙŠÙ†
        if (total === 10) return "Ø³ÙŠÙ† 1"; // ØªØµØ¨Ø­ Ø³ÙŠÙ† 1 Ø«Ù„Ø§Ø« ÙˆØ­Ø¯Ø§Øª
        if (total === 11) return "Ø¨Ø§Ø¡ 1"; // ØªØµØ¨Ø­ Ø¨Ø§Ø¡ 1 Ø«Ù„Ø§Ø« ÙˆØ­Ø¯Ø§Øª
        if (total === 12) return "Ø³ÙŠÙ†";   // ØªØµØ¨Ø­ Ø³ÙŠÙ† Ø«Ù„Ø§Ø« ÙˆØ­Ø¯Ø§Øª
        if (total === 13) return "Ø¬ÙŠÙ… 1"; // ØªØµØ¨Ø­ Ø¬ÙŠÙ… 1 Ø«Ù„Ø§Ø« ÙˆØ­Ø¯Ø§Øª
        if (total === 14) return "Ø³ÙŠÙ† 1"; // ØªØµØ¨Ø­ Ø³ÙŠÙ† 1 Ø£Ø±Ø¨Ø¹ ÙˆØ­Ø¯Ø§Øª
        if (total === 15) return "Ø³ÙŠÙ†";   // ØªØµØ¨Ø­ Ø³ÙŠÙ† Ø£Ø±Ø¨Ø¹ ÙˆØ­Ø¯Ø§Øª
        if (total === 16) return "Ø¨Ø§Ø¡";   // ØªØµØ¨Ø­ Ø¨Ø§Ø¡ Ø«Ù„Ø§Ø« ÙˆØ­Ø¯Ø§Øª (Ø­Ø³Ø¨ Ø§Ù„Ù†Øµ)
        if (total === 17) return "Ø¨Ø§Ø¡";   // ØªØµØ¨Ø­ Ø¨Ø§Ø¡ Ø£Ø±Ø¨Ø¹ ÙˆØ­Ø¯Ø§Øª
        if (total >= 18 && total <= 20) return "Ø¬ÙŠÙ… 2"; // Ù…Ù† ÙˆØ­Ø¯Ø© Ø¥Ù„Ù‰ Ø«Ù„Ø§Ø«

        return "Ø³ÙŠÙ† 1";
    }

    function setMode(m) {
        mode = m;
        document.getElementById('btnLS').className = 'tab-btn' + (m==='LS'?' active-ls':'');
        document.getElementById('btnSB').className = 'tab-btn' + (m==='SB'?' active-sb':'');
        render();
    }

    document.getElementById('codeIn').addEventListener('input', function(e) {
        let val = e.target.value.replace(/\D/g, '');
        if (val.length >= 3) {
            let fullCode = activeLetter + "-" + val;
            let target = (mode === 'LS') ? getTargetLS() : getTargetSB();
            
            // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± (Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©)
            let exists = false;
            for(let k in data[mode]) if(data[mode][k].includes(fullCode)) exists = true;
            if(exists && !["Ù‚ÙŠØ§Ø¯Ø©", "Ø§Ø´Ø±Ø§Ù Ø¹Ø§Ù…", "Ù…Ø´Ø±Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ"].includes(target)) {
                alert("Ø§Ù„ÙƒÙˆØ¯ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹!");
            } else {
                data[mode][target].push(fullCode);
                history.push({mode: mode, target: target});
            }
            e.target.value = '';
            render();
        }
    });

    function render() {
        const area = document.getElementById('displayArea');
        area.innerHTML = '';
        const currentData = data[mode];
        const currentKeys = (mode === 'LS') ? keysLS : keysSB;

        currentKeys.forEach(k => {
            let card = document.createElement('div');
            card.className = 'card';
            let headerClass = (mode === 'LS') ? 'ls-h' : 'sb-h';
            card.innerHTML = `<div class="card-header ${headerClass}">${k}</div><div class="card-body"></div>`;
            currentData[k].forEach((u, index) => {
                let tag = document.createElement('div');
                tag.className = 'unit-tag';
                tag.innerText = u;
                tag.onclick = () => { if(confirm("Ø­Ø°Ù Ø§Ù„ÙˆØ­Ø¯Ø©ØŸ")) { currentData[k].splice(index,1); render(); } };
                card.querySelector('.card-body').appendChild(tag);
            });
            area.appendChild(card);
        });
    }

    function undo() {
        if(history.length > 0) {
            let last = history.pop();
            data[last.mode][last.target].pop();
            render();
        }
    }

    function resetData() {
        if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")) location.reload();
    }

    function copyReport() {
        let report = `ØªÙ‚Ø±ÙŠØ± Ø¹Ù…Ù„ÙŠØ§Øª (${mode === 'LS' ? 'Ù„ÙˆØ³ Ø³Ø§Ù†ØªÙˆØ³' : 'Ø³Ø§Ù†Ø¯ÙŠ ÙˆØ¨ÙˆÙ„ÙŠØªÙˆ'})\n\n`;
        const currentKeys = (mode === 'LS') ? keysLS : keysSB;
        currentKeys.forEach(k => {
            let units = data[mode][k].length > 0 ? data[mode][k].join('\n') : "E-000";
            if (k === "Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª" || k === "Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª") units = data[mode][k].join(' | ') || "E-000";
            report += `${k} :\n${units}\n\n`;
        });
        navigator.clipboard.writeText(report);
        alert("âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­");
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø±ÙˆÙ
    const alpha = ['E', 'A', 'F', 'M', 'S', 'C', 'G', 'P', 'H'];
    const lettersDiv = document.getElementById('letters');
    alpha.forEach(l => {
        let b = document.createElement('button');
        b.className = 'letter-btn' + (l === 'E' ? ' active' : '');
        b.innerText = l;
        b.onclick = () => {
            activeLetter = l;
            document.querySelectorAll('.letter-btn').forEach(x => x.classList.remove('active'));
            b.classList.add('active');
        };
        lettersDiv.appendChild(b);
    });

    render();
</script>

</body>
</html>
